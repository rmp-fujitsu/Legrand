<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.1" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format" exclude-result-prefixes="fo">
	<xsl:output method="xml" version="1.0" omit-xml-declaration="no" indent="yes"/>
	<xsl:template match="my_var_main">
		<fo:root font-family="Arial" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:w="http://schemas.microsoft.com/office/word/2003/wordml">
			<fo:layout-master-set xmlns:rx="http://www.renderx.com/XSL/Extensions" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wx="http://schemas.microsoft.com/office/word/2003/auxHint" xmlns:aml="http://schemas.microsoft.com/aml/2001/core" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
				<fo:simple-page-master master-name="section1-first-page" page-width="8.268055555555555in" page-height="11.693055555555556in" margin-top="21.25pt" margin-bottom="35.4pt" margin-right="70.85pt" margin-left="70.85pt">
					<fo:region-body margin-top="56.7pt" margin-bottom="21.25pt"></fo:region-body>
					<fo:region-before region-name="first-page-header" extent="11in"></fo:region-before>
					<fo:region-after region-name="first-page-footer" extent="11in" display-align="after"></fo:region-after>
				</fo:simple-page-master>
				<fo:simple-page-master master-name="section1-odd-page" page-width="8.268055555555555in" page-height="11.693055555555556in" margin-top="21.25pt" margin-bottom="35.4pt" margin-right="70.85pt" margin-left="70.85pt">
					<fo:region-body margin-top="56.7pt" margin-bottom="21.25pt"></fo:region-body>
					<fo:region-before region-name="odd-page-header" extent="11in"></fo:region-before>
					<fo:region-after region-name="odd-page-footer" extent="11in" display-align="after"></fo:region-after>
				</fo:simple-page-master>
				<fo:simple-page-master master-name="section1-even-page" page-width="8.268055555555555in" page-height="11.693055555555556in" margin-top="21.25pt" margin-bottom="35.4pt" margin-right="70.85pt" margin-left="70.85pt">
					<fo:region-body margin-top="56.7pt" margin-bottom="21.25pt"></fo:region-body>
					<fo:region-before region-name="even-page-header" extent="11in"></fo:region-before>
					<fo:region-after region-name="even-page-footer" extent="11in" display-align="after"></fo:region-after>
				</fo:simple-page-master>
				<fo:page-sequence-master master-name="section1-page-sequence-master">
					<fo:repeatable-page-master-alternatives>
						<fo:conditional-page-master-reference page-position="first" master-reference="section1-first-page" />
						<fo:conditional-page-master-reference page-position="rest" master-reference="section1-odd-page" />
						<!-- <fo:conditional-page-master-reference odd-or-even="odd" master-reference="section1-odd-page" />
						<fo:conditional-page-master-reference odd-or-even="even" master-reference="section1-even-page" /> -->
					</fo:repeatable-page-master-alternatives>
				</fo:page-sequence-master>
			</fo:layout-master-set>
			<fo:page-sequence master-reference="section1-page-sequence-master" format="1" xmlns:rx="http://www.renderx.com/XSL/Extensions" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wx="http://schemas.microsoft.com/office/word/2003/auxHint" xmlns:aml="http://schemas.microsoft.com/aml/2001/core" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
                <fo:static-content flow-name="first-page-header">
                    <fo:retrieve-marker retrieve-class-name="first-page-header" retrieve-position="first-including-carryover" retrieve-boundary="page" />
                </fo:static-content>
                <fo:static-content flow-name="first-page-footer">
                    <fo:retrieve-marker retrieve-class-name="first-page-footer" retrieve-position="first-including-carryover" retrieve-boundary="page" />
                </fo:static-content>
                <fo:static-content flow-name="odd-page-header">
                    <fo:retrieve-marker retrieve-class-name="odd-page-header" retrieve-position="first-including-carryover" retrieve-boundary="page" />
                </fo:static-content>
                <fo:static-content flow-name="odd-page-footer">
                    <fo:retrieve-marker retrieve-class-name="odd-page-footer" retrieve-position="first-including-carryover" retrieve-boundary="page" />
                </fo:static-content>
                <fo:static-content flow-name="even-page-header">
                    <fo:retrieve-marker retrieve-class-name="even-page-header" retrieve-position="first-including-carryover" retrieve-boundary="page" />
                </fo:static-content>
                <fo:static-content flow-name="even-page-footer">
                    <fo:retrieve-marker retrieve-class-name="even-page-footer" retrieve-position="first-including-carryover" retrieve-boundary="page" />
                </fo:static-content>
                <fo:static-content flow-name="xsl-footnote-separator">
                    <fo:block>
                        <fo:leader leader-pattern="rule" leader-length="144pt" rule-thickness="0.5pt" rule-style="solid" color="gray" />
                    </fo:block>
                </fo:static-content>
                <fo:flow flow-name="xsl-region-body">
                    <fo:block widows="2" orphans="2" font-size="10pt" line-height="1.147" white-space-collapse="false">
                        <fo:marker marker-class-name="first-page-header" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
                            <fo:block space-after="0pt" space-after.conditionality="retain" line-height="1.147" font-family="Arial" font-size="11pt" language="FR" text-align="center">
                                <fo:inline>
                                    <fo:external-graphic content-width="138.1pt" content-height="55.35pt" src="url('https://live.runmyprocess.com/live/112501487582701289/upload/1e118730-9d4c-11e7-9c4e-0619bd984419/logo_total_color.png')"></fo:external-graphic>
                                </fo:inline>
                            </fo:block>
                        </fo:marker>                        	
                        <fo:marker marker-class-name="first-page-footer" xmlns:st1="urn:schemas-microsoft-com:office:smarttags" />
                        <fo:marker marker-class-name="odd-page-header" xmlns:st1="urn:schemas-microsoft-com:office:smarttags" />
                        <fo:marker marker-class-name="odd-page-footer" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
                            <fo:block space-after="0pt" space-after.conditionality="retain" line-height="1.147" font-family="Arial" font-size="11pt" language="FR" text-align="center">
                                <fo:inline>
                                    <fo:leader leader-length="0pt" />
                                    <fo:page-number />
                                </fo:inline>
                                <fo:inline>
                                    <fo:leader leader-length="0pt" /> / </fo:inline>
                                <fo:inline>
                                    <fo:leader leader-length="0pt" />
                                    <fo:page-number-citation ref-id="ID1A2WWHPOC0QLDGUBACIXJA04BICJVD30RIZ5LZH4WBNZ0Q0RHO" />
                                </fo:inline>
                            </fo:block>
                        </fo:marker>
                        <fo:marker marker-class-name="even-page-header" xmlns:st1="urn:schemas-microsoft-com:office:smarttags" />
                        <fo:marker marker-class-name="even-page-footer" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
                            <fo:block space-after="0pt" space-after.conditionality="retain" line-height="1.147" font-family="Arial" font-size="11pt" language="FR" text-align="center">
                                <fo:inline>
                                    <fo:leader leader-length="0pt" />
                                    <fo:page-number />
                                </fo:inline>
                                <fo:inline>
                                    <fo:leader leader-length="0pt" /> / </fo:inline>
                                <fo:inline>
                                    <fo:leader leader-length="0pt" />
                                    <fo:page-number-citation ref-id="ID1A2WWHPOC0QLDGUBACIXJA04BICJVD30RIZ5LZH4WBNZ0Q0RHO" />
                                </fo:inline>
                            </fo:block>
                        </fo:marker>

						<fo:block space-after="8pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="16pt" language="FR" text-align="center" font-weight="bold" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
                            <fo:leader />
                        </fo:block>
						<fo:block space-after="10pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="18pt" language="FR" text-align="center" font-weight="bold" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
							<fo:inline font-weight="bold" font-size="18pt">
								<fo:leader leader-length="0pt" />CAMPAGNE REMPLACEMENT TPI
							</fo:inline>
						</fo:block>
						<fo:block space-after="10pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="18pt" language="FR" text-align="center" font-weight="bold" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
							<fo:inline font-weight="bold" font-size="18pt">
								<fo:leader leader-length="0pt" />APPLICATION DE RÉCEPTION DES CHANTIERS
							</fo:inline>
						</fo:block>
						<fo:block space-after="10pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="12pt" language="FR" text-align="center" font-weight="bold" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
							<fo:leader />
						</fo:block>



<!-- ======================= -->
<!-- FIN DE LA PREMIERE PAGE -->
<!-- ======================= -->

<!-- Vision d'ensemble signalétique Entrée d'îlot et Poteau d'auvent -->
                        <fo:table font-family="Arial" language="FR" start-indent="0pt" border-top-style="solid" border-top-color="black" border-top-width="0.5pt" border-left-style="solid" border-left-color="black" border-left-width="0.5pt" border-bottom-style="solid" border-bottom-color="black" border-bottom-width="0.5pt" border-right-style="solid" border-right-color="black" border-right-width="0.5pt" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
                            <fo:table-column column-number="1" column-width="482pt" />
                            <fo:table-body start-indent="0pt" end-indent="0pt">

                                <xsl:call-template name="domain_template">
                                    <xsl:with-param name="domain_title"><xsl:value-of select="domaine_ilot_et_auvent" /></xsl:with-param>
                                </xsl:call-template>

                                <xsl:call-template name="photos_array_test">
                                    <xsl:with-param name="domain_title"><xsl:value-of select="domaine_ilot_et_auvent" /></xsl:with-param>
                                </xsl:call-template>

                                <xsl:call-template name="comments_template">
                                    <xsl:with-param name="commentaires"><xsl:value-of select="commentaires_ilot_et_auvent" /></xsl:with-param>
                                </xsl:call-template>

                            </fo:table-body>
                        </fo:table>

<!--                         <fo:block page-break-after="always" space-after="8pt" space-after.conditionality="retain" line-height="1.2378041666666666" font-family="Arial" font-size="12pt" language="FR" font-weight="bold" xmlns:st1="urn:schemas-microsoft-com:office:smarttags" /> -->


<!-- ======================= -->
<!-- BAS DE LA DERNERE PAGE  -->
<!-- ======================= -->
                        <fo:block space-after="10pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="11pt" language="FR" xmlns:st1="urn:schemas-microsoft-com:office:smarttags">
                            <fo:leader leader-length="0pt" />
                        </fo:block>
                        
                        <fo:block id="ID1A2WWHPOC0QLDGUBACIXJA04BICJVD30RIZ5LZH4WBNZ0Q0RHO" />

                    </fo:block>
                </fo:flow>
            </fo:page-sequence>
        </fo:root>
    </xsl:template>

    <!-- ============== -->
    <!-- CHILD TEMPLATE -->
    <!-- ============== -->

    <!-- Template for images  -->
    <xsl:template name="photos_array_test">
        <xsl:param name="domain_title" />
        <!-- <xsl:param name="photos_array" /> -->
        <xsl:choose>
            <!-- <xsl:when test="$domain_title = 'Vision d&quot;ensemble signalétique Entrée d\&quot;îlot et Poteau d&quot;auvent'"> -->
            <xsl:when test="contains($domain_title, 'auvent')">
                <xsl:variable name="photos_ilot_et_auvent"><xsl:value-of select="photos_ilot_et_auvent"/></xsl:variable>
                <xsl:apply-templates select="photos_ilot_et_auvent" />
            </xsl:when>
            <xsl:otherwise></xsl:otherwise>
        </xsl:choose>
    </xsl:template>

<!-- ============================================================ -->
<!-- Template for photos_ilot_et_auvent (3 images MAX) -->
    <xsl:template match="photos_ilot_et_auvent">
        <!-- <xsl:variable name="img_url"><xsl:value-of select="url" /></xsl:variable> -->
        <!-- <xsl:variable name="curl"><xsl:value-of select="{concat('url(',$url,')')}" /></xsl:variable> -->
        <!-- <xsl:variable name="img_url"><xsl:text>url('</xsl:text><xsl:value-of select="url" /><xsl:text>')</xsl:text></xsl:variable> -->

        <xsl:if test="nb_photos_ilot_et_auvent != '0'">
            <fo:table-row>
                <fo:table-cell padding-top="5pt" padding-left="5.4pt" padding-bottom="0pt" padding-right="5.4pt" border-left-style="solid" border-right-style="solid" border-left-color="black" border-right-color="black" border-left-width="0.25pt" border-right-width="0.25pt" border-top-style="solid" border-bottom-style="solid" border-top-color="black" border-bottom-color="black" border-top-width="0.25pt" border-bottom-width="0.25pt" background-color="white">
                    <fo:block space-after="5pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="11pt" language="FR" text-align="center">
                        <fo:external-graphic margin-left="auto" margin-right="auto" content-width="scale-down-to-fit" height="100%" width="450px" scaling="uniform" src="{$img_url}" />
                    </fo:block>
                </fo:table-cell>
            </fo:table-row>
        </xsl:if>

    </xsl:template>


<!-- ============================================================ -->

<!-- Template for url image -->
    <xsl:template name="url_template">
        <xsl:param name="img_url" />
        <fo:table-row>
            <fo:table-cell padding-top="0pt" padding-left="5.4pt" padding-bottom="0pt" padding-right="5.4pt" border-left-style="solid" border-right-style="solid" border-left-color="black" border-right-color="black" border-left-width="0.25pt" border-right-width="0.25pt" border-top-style="solid" border-bottom-style="none" border-top-color="black" border-bottom-color="black" border-top-width="0.25pt" border-bottom-width="0pt" background-color="white">
                <fo:block space-after="10pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="11pt" language="FR">
                    <fo:external-graphic margin-left="auto" margin-right="auto" content-width="scale-down-to-fit" height="100%" width="450px" scaling="uniform" src="{$img_url}" />
                </fo:block>
                <fo:block space-after="10pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="9pt" language="FR">
                </fo:block>
            </fo:table-cell>
        </fo:table-row>
    </xsl:template>

<!-- Template for domain title -->
    <xsl:template name="domain_template">
        <xsl:param name="domain_title" />
        <fo:table-row>
            <fo:table-cell padding-top="5pt" padding-left="5.4pt" padding-bottom="0pt" padding-right="5.4pt" border-left-style="solid" border-right-style="solid" border-left-color="black" border-right-color="black" border-left-width="0.25pt" border-right-width="0.25pt" border-top-style="solid" border-bottom-style="solid" border-top-color="black" border-bottom-color="black" border-top-width="0.25pt" border-bottom-width="0.25pt" background-color="#0070C0">
                <fo:block space-after="5pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="11pt" language="FR" text-align="center" font-weight="bold">
                    <fo:inline font-weight="bold" color="#FFFFFF" font-size="12pt" language="">
                        <fo:leader leader-length="0pt" /><xsl:value-of select="$domain_title" />
                    </fo:inline>
                </fo:block>
            </fo:table-cell>
        </fo:table-row>
    </xsl:template>

<!-- Template for commentaires -->
    <xsl:template name="comments_template">
        <xsl:param name="commentaires" />
        <fo:table-row>
            <fo:table-cell padding-top="10pt" padding-left="5.4pt" padding-bottom="0pt" padding-right="5.4pt" border-left-style="solid" border-right-style="solid" border-left-color="black" border-right-color="black" border-left-width="0.25pt" border-right-width="0.25pt" border-top-style="none" border-bottom-style="solid" border-top-color="black" border-bottom-color="black" border-top-width="0pt" border-bottom-width="0.25pt" background-color="white">
                <fo:block space-after="10pt" space-after.conditionality="retain" line-height="1.3190500000000002" font-family="Arial" font-size="9pt" language="FR">
                    <xsl:choose>
                        <xsl:when test="$commentaires != ''">
                            <fo:inline font-weight="bold">Commentaires: </fo:inline>
                            <fo:inline><xsl:value-of select="$commentaires" /></fo:inline>
                        </xsl:when>
                        <xsl:otherwise><fo:inline>Aucun commentaire</fo:inline>
                        </xsl:otherwise>
                    </xsl:choose>
                </fo:block>
            </fo:table-cell>
        </fo:table-row>
    </xsl:template>

</xsl:stylesheet>